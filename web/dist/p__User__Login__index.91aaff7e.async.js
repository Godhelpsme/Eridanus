"use strict";(self.webpackChunkant_design_pro=self.webpackChunkant_design_pro||[]).push([[366],{2067:function(ee,v,e){e.r(v);var W=e(15009),l=e.n(W),T=e(97857),D=e.n(T),S=e(99289),h=e.n(S),y=e(5574),p=e.n(y),R=e(13544),A=e(87547),B=e(94149),K=e(84713),M=e(38480),c=e(76772),x=e(40056),O=e(2453),w=e(67610),L=e(67294),$=e(73935),z=e(28846),Z=e(91094),ne=e.n(Z),t=e(85893),G=(0,z.kc)(function(P){var r=P.token;return{container:{display:"flex",flexDirection:"column",height:"100vh",overflow:"auto",backgroundSize:"100% 100%"}}}),k=function(r){var i=r.content;return(0,t.jsx)(x.Z,{style:{marginBottom:24},message:i,type:"error",showIcon:!0})},F=function(){var r=localStorage.getItem("auth_token");r&&(document.cookie="auth_token=".concat(r,"; path=/"),fetch("/api/profile",{method:"GET",headers:{auth:"".concat(r)}}).then(function(i){if(i.ok){try{var f=i.json()}catch(I){console.log("data error")}if(data.name!==""){var g=new URL(window.location.href).searchParams;c.history.push(g.get("redirect")||"/")}}}).catch(function(){localStorage.removeItem("auth"),document.cookie=""}))},N=function(){var r=(0,L.useState)({}),i=p()(r,2),f=i[0],g=i[1],I=(0,L.useState)("account"),U=p()(I,2),te=U[0],ae=U[1],b=(0,c.useModel)("@@initialState"),m=b.initialState,H=b.setInitialState,J=G(),V=J.styles,Q=function(){var d=h()(l()().mark(function o(){var s,u;return l()().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,m==null||(s=m.fetchUserInfo)===null||s===void 0?void 0:s.call(m);case 2:u=a.sent,u&&(0,$.flushSync)(function(){H(function(E){return D()(D()({},E),{},{currentUser:u})})});case 4:case"end":return a.stop()}},o)}));return function(){return d.apply(this,arguments)}}(),X=function(){var d=h()(l()().mark(function o(s){var u,_,a,E,j,C;return l()().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,u=(0,Z.sha3_256)(s.password||""),n.next=4,fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({account:s.account,password:u})});case 4:return _=n.sent,n.next=7,_.json();case 7:if(a=n.sent,!(_.ok&&a.message==="Success")){n.next=18;break}return E="\u767B\u5F55\u6210\u529F\uFF01",O.ZP.success(E),localStorage.setItem("auth_token",a.auth_token),document.cookie="auth_token=".concat(a.auth_token,"; path=/"),n.next=15,Q();case 15:return j=new URL(window.location.href).searchParams,c.history.push(j.get("redirect")||"/"),n.abrupt("return");case 18:g({status:"error",type:"account"}),n.next=26;break;case 21:n.prev=21,n.t0=n.catch(0),C="\u767B\u5F55\u5931\u8D25\uFF0C\u8BF7\u91CD\u8BD5\uFF01",console.log(n.t0),O.ZP.error(C);case 26:case"end":return n.stop()}},o,null,[[0,21]])}));return function(s){return d.apply(this,arguments)}}(),Y=f.status,q=f.type;return(0,L.useEffect)(function(){F()},[]),(0,t.jsxs)("div",{className:V.container,children:[(0,t.jsx)(c.Helmet,{children:(0,t.jsxs)("title",{children:["\u767B\u5F55"," - ",w.Z.title]})}),(0,t.jsx)("div",{style:{flex:"1",padding:"32px 0"},children:(0,t.jsxs)(K.U,{contentStyle:{minWidth:280,maxWidth:"75vw"},logo:(0,t.jsx)("img",{alt:"logo",src:"/icons/icon-192x192.png"}),title:"Eridanus WebUI",subTitle:"\u8BF7\u767B\u5F55",initialValues:{autoLogin:!0},onFinish:function(){var d=h()(l()().mark(function o(s){return l()().wrap(function(_){for(;;)switch(_.prev=_.next){case 0:return _.next=2,X(s);case 2:case"end":return _.stop()}},o)}));return function(o){return d.apply(this,arguments)}}(),children:[Y==="error"&&q==="account"&&(0,t.jsx)(k,{content:"\u7528\u6237\u540D\u6216\u5BC6\u7801\u9519\u8BEF"}),(0,t.jsx)(M.Z,{name:"account",fieldProps:{size:"large",prefix:(0,t.jsx)(A.Z,{})},placeholder:"\u7528\u6237\u540D",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u7528\u6237\u540D"}]}),(0,t.jsx)(M.Z.Password,{name:"password",fieldProps:{size:"large",prefix:(0,t.jsx)(B.Z,{})},placeholder:"\u5BC6\u7801",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u5BC6\u7801"}]})]})}),(0,t.jsx)(R.$_,{})]})};v.default=N}}]);
